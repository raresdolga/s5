program: run_train
name: listops_rotrnn_sweep
project: simple_rotrnn_sweeps
entity: baesian-learning
method: grid
metric:
  name: Best Val Accuracy
  goal: maximize
parameters:
  nheads:
    value: 32
  global_lr:
    values: [0.001, 0.003]
  ssm_lr_base:
    value: [0.001, 0.0005]
  r_min:
    values: [0.001, 0.1, 0.5]
  r_max:
    values: [0.999, 0.9999]
  max_phase:
    values: 0.0314
  p_dropout:
    values: [0.0, 0.05, 0.1]
  weight_decay:
    value: 0.05
  opt_config:
    value: 'BfastandCdecay'
  ssm_type:
    value: "rotblock"

command:
- pdm
- run
- python
- "-u"
- "-m"
- ${program}
- "--batchnorm"
- "True"
- "--bn_momentum"
- "0.95"
- "--bidirectional"
- "True"
- "--bsz"
- "50"
- "--d_model"
- "128"
- "--dataset"
- "listops-classification"
- "--epochs"
- "40"
- "--jax_seed"
- "6554595"
- "--n_layers"
- "8"
- "--ssm_size_base"
- "128"
- "--warmup_end"
- "1"
- "--USE_WANDB"
- "True"
- ${args}
- "--wandb_project"
- "simple_rotrnn_sweeps"
- "--wandb_entity"
- "baesian-learning"