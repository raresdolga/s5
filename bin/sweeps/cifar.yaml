program: run_train
name: cifar_rotrnn_sweep
project: rotrnn_clean_sweeps
entity: baesian-learning
method: grid
metric:
  name: Best Val Accuracy
  goal: maximize
parameters:
  global_lr:
    value: 0.004
  ssm_lr_base:
    values: [0.001, 0.0005]
  r_min:
    values: [0.001, 0.5, 0.9]
  r_max:
    values: [0.999, 0.9999]
  p_dropout:
    values: [0.1, 0.0]
  weight_decay:
    value: 0.05
  max_phase:
    values: [0.0314, 0.314, 3.14]
  nheads:
    values: [32, 64]
  opt_config:
    value: "standard"
  ssm_type:
    value: "rotrnn"
  activation_fn:
    value: "full_glu"
  batchnorm:
    value: "True"
  bn_momentum:
    value: 0.95
  bidirectional:
    value: "False"
  bsz:
    value: 50
  d_model:
    value: 512
  dataset:
    value: "lra-cifar-classification"
  epochs:
    value: 250
  jax_seed:
    value: 16416
  n_layers:
    value: 6
  ssm_size_base:
    value: 384
  warmup_end:
    value: 1
  
command:
- pdm
- run
- python
- "-u"
- "-m"
- ${program}
- "--USE_WANDB"
- "True"
- ${args}
- "--wandb_project"
- "s5_rotrnn"
- "--wandb_entity"
- "baesian-learning"