program: run_train
name: cifar_rotrnn_sweep
project: ssmrot_lra_sweeps
entity: baesian-learning
method: grid
metric:
  name: max_eval_test_accuracy
  goal: maximize
parameters:
  # nheads:
  #   values: [16, 32, 64]
  lr_factor:
    values: [4.5, 2, 1]
  r_min:
    values: [0.5, 0.9, 0.99]
  r_max:
    values: [0.999, 0.9999, 0.99999]
  max_phase:
    values: [0.0314, 0.314, 6.28]  # pi/100, pi/10, 2pi
  ssm_type:
    value: "rotblock" # "lru"

command:
- pdm
- run
- python
- "-u"
- "-m"
- ${program}
- "--C_init"
- "lecun_normal"
- "--batchnorm"
- "True"
- "--bidirectional"
- "False"
- "--blocks"
- "3"
- "--bsz"
- "50"
- "--clip_eigs"
- "True"
- "--d_model"
- "512"
- "--dataset"
- "lra-cifar-classification"
- "--epochs"
- "250"
- "--jax_seed"
- "16416"
- "--n_layers"
- "6"
- "--opt_config"
- "BfastandCdecay"
- "--p_dropout"
- "0.1"
- "--ssm_lr_base"
- "0.001"
- "--ssm_size_base"
- "384"
- "--warmup_end"
- "1"
- "--weight_decay"
- "0.07"
- "--USE_WANDB"
- "True"
- ${args}
- "--wandb_project"
- "s5_lra_sweeps"
- "--wandb_entity"
- "baesian-learning"